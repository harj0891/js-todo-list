(()=>{"use strict";const e=function(e,t,n,a){var o;return{id:(o=r.readProjectArray(),0==o.length?1:o.length>0?o[o.length-1].id+1:void 0),title:e,description:t,dueDate:n,labelColor:a}},t=function(e,t,n,a){var o=r.readItemArray();return{id:0==o.length?1:o.length>0?o[o.length-1].id+1:void 0,title:e,description:t,dueDate:a,project:n,isComplete:!1}},r={readProjectArray:function(){var t=JSON.parse(localStorage.getItem("projects")||"[]");return t.length>0&&t.forEach((function(t){Object.assign(e,t)})),t},readItemArray:function(){var e=JSON.parse(localStorage.getItem("items")||"[]");return e.length>0&&e.forEach((function(e){Object.assign(t,e)})),e},saveProjectArray:function(e){localStorage.setItem("projects",JSON.stringify(e))},saveItemArray:function(e){localStorage.setItem("items",JSON.stringify(e))}},n=function(){function e(){var n=r.readProjectArray(),c=r.readItemArray(),d=document.querySelector("#container-todolist");d.innerHTML="",n.forEach((function(n){var i=document.createElement("section");switch(i.setAttribute("id","container-project-".concat(n.id)),n.labelColor){case"grey":i.setAttribute("class","label-grey");break;case"blue":i.setAttribute("class","label-blue");break;case"red":i.setAttribute("class","label-red");break;case"green":i.setAttribute("class","label-green")}var l=document.createElement("p");l.textContent="Project: ".concat(n.title," Description: ").concat(n.description," Due: ").concat(n.dueDate);var u=document.createElement("button");u.textContent="+",u.addEventListener("click",(function(){var t=function(t){if(!document.querySelector("#create-item-form-p".concat(t))){var r=document.createElement("section");r.setAttribute("id","create-item-form-p".concat(t));var n=document.createElement("label");n.setAttribute("for","itemname"),n.textContent="Name";var o=document.createElement("input");o.setAttribute("id","itemname");var c=document.createElement("label");c.setAttribute("for","itemdesc"),c.textContent="Description";var d=document.createElement("input");d.setAttribute("id","itemdesc");var i=document.createElement("label");i.setAttribute("for","itemduedate"),i.textContent="Due Date";var l=document.createElement("input");l.setAttribute("id","itemduedate"),l.setAttribute("type","date");var u=document.createElement("button");return u.textContent="Create item",r.appendChild(n),r.appendChild(o),r.appendChild(c),r.appendChild(d),r.appendChild(i),r.appendChild(l),r.appendChild(u),u.addEventListener("click",(function(){!function(t){var r=document.querySelector("#itemname").value,n=document.querySelector("#itemdesc").value,o=document.querySelector("#itemduedate").value;a.createItem(r,n,t,o),e()}(t)})),r}console.log("item create form already open")}(n.id);t&&i.appendChild(t)}));var p=document.createElement("button");p.textContent="EDIT",p.addEventListener("click",(function(){!function(t){for(var n,o=r.readProjectArray(),c=0;c<o.length;c++)o[c].id==t&&(n=o[c]);var d=document.querySelector("#container-project-".concat(n.id));if(document.querySelector("#update-project-form"))console.log("project update form already open");else{var i=document.createElement("section");i.setAttribute("id","update-project-form");var l=document.createElement("label");l.setAttribute("for","pname"),l.textContent="Name";var u=document.createElement("input");u.setAttribute("id","pname"),u.value=n.title;var p=document.createElement("label");p.setAttribute("for","pdesc"),p.textContent="Description";var m=document.createElement("input");m.setAttribute("id","pdesc"),m.value=n.description;var s=document.createElement("label");s.setAttribute("for","pduedate"),s.textContent="Due Date";var v=document.createElement("input");v.setAttribute("id","pduedate"),v.setAttribute("type","date"),v.value=n.dueDate;var b=document.createElement("label");b.setAttribute("for","pcolor"),b.textContent="Colour";var C=document.createElement("select");C.setAttribute("id","pcolor");var h=document.createElement("option");h.setAttribute("value","grey"),h.textContent="Grey";var f=document.createElement("option");f.setAttribute("value","blue"),f.textContent="Blue";var A=document.createElement("option");A.setAttribute("value","red"),A.textContent="Red";var E=document.createElement("option");switch(E.setAttribute("value","green"),E.textContent="Green",C.appendChild(h),C.appendChild(f),C.appendChild(A),C.appendChild(E),n.labelColor){case"grey":h.setAttribute("selected","selected");break;case"blue":f.setAttribute("selected","selected");break;case"red":A.setAttribute("selected","selected");break;case"green":E.setAttribute("selected","selected")}var y=document.createElement("button");y.textContent="Update project",i.appendChild(l),i.appendChild(u),i.appendChild(p),i.appendChild(m),i.appendChild(s),i.appendChild(v),i.appendChild(b),i.appendChild(C),i.appendChild(y),d.firstChild.style.display="none",d.insertBefore(i,d.firstChild),y.addEventListener("click",(function(){var t,r,o,c,d;t=n.id,r=u.value,o=m.value,c=v.value,d=C.value,a.updateProject(t,r,o,c,d),e()}))}}(n.id)}));var m=document.createElement("button");m.textContent="DELETE",m.addEventListener("click",(function(){!function(r){var n=document.querySelector("#container-todolist");if(document.querySelector("#delete-project-modal"))return!1;var o=document.createElement("section");o.setAttribute("id","delete-project-modal"),o.setAttribute("class","modal");var c=document.createElement("section");c.setAttribute("class","modal-content");var d=document.createElement("p");d.textContent="Are you sure you want to delete ".concat(r.title);var i=document.createElement("button");i.textContent="Yes",i.addEventListener("click",(function(){var t;t=r.id,a.deleteProject(t),e()}));var l=document.createElement("button");l.textContent="No",l.addEventListener("click",(function(){t()})),c.appendChild(d),c.appendChild(i),c.appendChild(l),o.appendChild(c),n.appendChild(o),window.onclick=function(e){e.target==o&&t()}}(n)})),i.appendChild(l),i.appendChild(p),i.appendChild(m),c.forEach((function(t){if(t.project==n.id){var c=document.createElement("section");c.setAttribute("id","container-item-".concat(t.id)),c.setAttribute("class","item");var d=document.createElement("input");d.setAttribute("id","item-checkbox"),d.setAttribute("type","checkbox"),d.addEventListener("change",(function(){o(t.id,t.title,t.description,t.dueDate,this.checked)})),t.isComplete&&(c.setAttribute("class","item completed"),d.checked=!0);var l=document.createElement("p");l.textContent="Task: ".concat(t.title," Description: ").concat(t.description," Due: ").concat(t.dueDate);var u=document.createElement("button");u.textContent="edit",u.addEventListener("click",(function(){!function(e){for(var t,n=r.readItemArray(),a=0;a<n.length;a++)n[a].id==e&&(t=n[a]);var c=document.querySelector("#container-item-".concat(t.id));if(document.querySelector("#update-item-form-".concat(t.id)))console.log("item update form already open");else{var d=document.createElement("section");d.setAttribute("id","update-item-form-".concat(t.id));var i=document.createElement("label");i.setAttribute("for","itemname"),i.textContent="Name";var l=document.createElement("input");l.setAttribute("id","itemname"),l.value=t.title;var u=document.createElement("label");u.setAttribute("for","itemdesc"),u.textContent="Description";var p=document.createElement("input");p.setAttribute("id","itemdesc"),p.value=t.description;var m=document.createElement("label");m.setAttribute("for","itemduedate"),m.textContent="Due Date";var s=document.createElement("input");s.setAttribute("id","itemduedate"),s.setAttribute("type","date"),s.value=t.dueDate;var v=document.createElement("button");v.textContent="Update item",d.appendChild(i),d.appendChild(l),d.appendChild(u),d.appendChild(p),d.appendChild(m),d.appendChild(s),d.appendChild(v);for(var b=c.childNodes,C=0;C<b.length;C++)b[C].style.display="none";c.insertBefore(d,c.firstChild),v.addEventListener("click",(function(){o(t.id,l.value,p.value,s.value,t.isComplete)}))}}(t.id)}));var p=document.createElement("button");p.textContent="x",p.addEventListener("click",(function(){var r;r=t.id,a.deleteItem(r),e()})),c.appendChild(d),c.appendChild(l),c.appendChild(u),c.appendChild(p),i.appendChild(c)}})),i.appendChild(u),d.appendChild(i)}))}function t(){document.querySelector("#delete-project-modal").remove()}function n(){var t=document.querySelector("#pname").value,r=document.querySelector("#pdesc").value,n=document.querySelector("#pduedate").value,o=document.querySelector("#pcolor").value;a.createProject(t,r,n,o),e(),document.querySelector("#create-project-form").remove()}function o(t,r,n,o,c){a.updateItem(t,r,n,o,c),e()}return document.querySelector("#create-project").addEventListener("click",(function(){!function(){var e=document.querySelector("#container-navigation");if(document.querySelector("#create-project-form"))console.log("project create form already open");else{var t=document.createElement("section");t.setAttribute("id","create-project-form");var r=document.createElement("label");r.setAttribute("for","pname"),r.textContent="Name";var a=document.createElement("input");a.setAttribute("id","pname");var o=document.createElement("label");o.setAttribute("for","pdesc"),o.textContent="Description";var c=document.createElement("input");c.setAttribute("id","pdesc");var d=document.createElement("label");d.setAttribute("for","pduedate"),d.textContent="Due Date";var i=document.createElement("input");i.setAttribute("id","pduedate"),i.setAttribute("type","date");var l=document.createElement("label");l.setAttribute("for","pcolor"),l.textContent="Colour";var u=document.createElement("select");u.setAttribute("id","pcolor");var p=document.createElement("option");p.setAttribute("value","grey"),p.textContent="Grey";var m=document.createElement("option");m.setAttribute("value","blue"),m.textContent="Blue";var s=document.createElement("option");s.setAttribute("value","red"),s.textContent="Red";var v=document.createElement("option");v.setAttribute("value","green"),v.textContent="Green",u.appendChild(p),u.appendChild(m),u.appendChild(s),u.appendChild(v);var b=document.createElement("button");b.textContent="Create project",t.appendChild(r),t.appendChild(a),t.appendChild(o),t.appendChild(c),t.appendChild(d),t.appendChild(i),t.appendChild(l),t.appendChild(u),t.appendChild(b),e.appendChild(t),b.addEventListener("click",n)}}()})),{displayToDoList:e}}(),a=function(){function a(e){for(var t=r.readItemArray(),n=0;n<t.length;n++)t[n].id==e&&t.splice(n,1);r.saveItemArray(t)}return function(){var n=r.readProjectArray(),a=r.readItemArray();if(0==n.length){var o=e("Shopping","Grocery list","2021-05-01","green");n.push(o),r.saveProjectArray(n);var c=e("Fitness","Eye of the tiger","2021-04-27","blue");n.push(c),r.saveProjectArray(n);var d=e("Trading","Stocks and shares","2021-04-27","red");n.push(d),r.saveProjectArray(n)}if(0==a.length){var i=t("Fruit","apples, oranges, bananas",1,"2021-04-27");a.push(i),r.saveItemArray(a);var l=t("Pullups","3 x 10",1,"2021-04-27");a.push(l),r.saveItemArray(a);var u=t("Squats","5 sets of 8 x 90kg",2,"2021-04-27");a.push(u),r.saveItemArray(a)}}(),n.displayToDoList(),{createProject:function(t,n,a,o){var c=e(t,n,a,o),d=r.readProjectArray();d.push(c),r.saveProjectArray(d)},createItem:function(e,n,a,o){var c=t(e,n,a,o),d=r.readItemArray();d.push(c),r.saveItemArray(d)},updateProject:function(e,t,n,a,o){for(var c,d=r.readProjectArray(),i=0;i<d.length;i++)d[i].id==e&&(c=d[i]);c&&(c.title=t,c.description=n,c.dueDate=a,c.labelColor=o,r.saveProjectArray(d))},updateItem:function(e,t,n,a,o){for(var c,d=r.readItemArray(),i=0;i<d.length;i++)d[i].id==e&&(c=d[i]);c&&(c.title=t,c.description=n,c.dueDate=a,c.isComplete=o,r.saveItemArray(d))},deleteProject:function(e){for(var t=r.readProjectArray(),n=r.readItemArray(),o=0;o<n.length;o++)n[o].project==e&&a(n[o].id);for(o=0;o<t.length;o++)t[o].id===e&&t.splice(o,1);r.saveProjectArray(t)},deleteItem:a}}()})();