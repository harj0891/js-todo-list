(()=>{"use strict";const e=function(e,t,r,a){var c;return{id:(c=n.readProjectArray(),0==c.length?1:c.length>0?c[c.length-1].id+1:void 0),title:e,description:t,dueDate:r,labelColor:a}},t=function(e,t,r,a){var c=n.readItemArray();return{id:0==c.length?1:c.length>0?c[c.length-1].id+1:void 0,title:e,description:t,dueDate:a,project:r,isComplete:!1}},n={readProjectArray:function(){var t=JSON.parse(localStorage.getItem("projects")||"[]");return t.length>0&&t.forEach((function(t){Object.assign(e,t)})),t},readItemArray:function(){var e=JSON.parse(localStorage.getItem("items")||"[]");return e.length>0&&e.forEach((function(e){Object.assign(t,e)})),e},saveProjectArray:function(e){localStorage.setItem("projects",JSON.stringify(e))},saveItemArray:function(e){localStorage.setItem("items",JSON.stringify(e))}},r=function(){function e(){var d=n.readProjectArray(),i=document.querySelector("#container-navigation");i.innerHTML="",d.forEach((function(r){var o=document.createElement("section");switch(o.setAttribute("id","container-project-".concat(r.id)),r.labelColor){case"grey":o.setAttribute("class","project grey");break;case"blue":o.setAttribute("class","project blue");break;case"red":o.setAttribute("class","project red");break;case"green":o.setAttribute("class","project green")}var d=document.createElement("section"),l=document.createElement("p");l.setAttribute("class","project-title"),l.textContent=r.title;var u=document.createElement("p");u.setAttribute("class","project-description"),u.textContent=r.description;var p=document.createElement("p");p.setAttribute("class","project-duedate"),p.textContent=r.dueDate,d.appendChild(l),d.appendChild(u),d.appendChild(p);var s=document.createElement("button");s.setAttribute("class","button project update"),s.textContent="EDIT",s.addEventListener("click",(function(){!function(t){for(var r,c=n.readProjectArray(),o=0;o<c.length;o++)c[o].id==t&&(r=c[o]);var d=document.querySelector("#container-project-".concat(r.id));if(document.querySelector("#update-project-form"))console.log("project update form already open");else{var i=document.createElement("section");i.setAttribute("id","update-project-form");var l=document.createElement("label");l.setAttribute("for","pname"),l.textContent="Name";var u=document.createElement("input");u.setAttribute("id","pname"),u.value=r.title;var p=document.createElement("label");p.setAttribute("for","pdesc"),p.textContent="Description";var s=document.createElement("input");s.setAttribute("id","pdesc"),s.value=r.description;var m=document.createElement("label");m.setAttribute("for","pduedate"),m.textContent="Due Date";var v=document.createElement("input");v.setAttribute("id","pduedate"),v.setAttribute("type","date"),v.value=r.dueDate;var b=document.createElement("label");b.setAttribute("for","pcolor"),b.textContent="Colour";var C=document.createElement("select");C.setAttribute("id","pcolor");var h=document.createElement("option");h.setAttribute("value","grey"),h.textContent="Grey";var A=document.createElement("option");A.setAttribute("value","blue"),A.textContent="Blue";var f=document.createElement("option");f.setAttribute("value","red"),f.textContent="Red";var E=document.createElement("option");switch(E.setAttribute("value","green"),E.textContent="Green",C.appendChild(h),C.appendChild(A),C.appendChild(f),C.appendChild(E),r.labelColor){case"grey":h.setAttribute("selected","selected");break;case"blue":A.setAttribute("selected","selected");break;case"red":f.setAttribute("selected","selected");break;case"green":E.setAttribute("selected","selected")}var y=document.createElement("button");y.textContent="Update project",i.appendChild(l),i.appendChild(u),i.appendChild(p),i.appendChild(s),i.appendChild(m),i.appendChild(v),i.appendChild(b),i.appendChild(C),i.appendChild(y),d.firstChild.style.display="none",d.insertBefore(i,d.firstChild),y.addEventListener("click",(function(){var t,n,c,o,d;t=r.id,n=u.value,c=s.value,o=v.value,d=C.value,a.updateProject(t,n,c,o,d),e()}))}}(r.id)}));var m=document.createElement("button");m.setAttribute("class","button project delete"),m.textContent="DELETE",m.addEventListener("click",(function(){!function(n){var r=document.querySelector("#container");if(document.querySelector("#delete-project-modal"))return!1;var o=document.createElement("section");o.setAttribute("id","delete-project-modal"),o.setAttribute("class","modal");var d=document.createElement("section");d.setAttribute("class","modal-content");var i=document.createElement("p");i.textContent="Are you sure you want to delete ".concat(n.title);var l=document.createElement("button");l.textContent="Yes",l.addEventListener("click",(function(){var r;r=n.id,a.deleteProject(r),e(),t(),c()}));var u=document.createElement("button");u.textContent="No",u.addEventListener("click",(function(){c()})),d.appendChild(i),d.appendChild(l),d.appendChild(u),o.appendChild(d),r.appendChild(o),window.onclick=function(e){e.target==o&&c()}}(r)})),o.appendChild(d),o.appendChild(s),o.appendChild(m),o.addEventListener("click",(function(){t(r.id)})),i.appendChild(o)}));var l=document.createElement("button");l.setAttribute("class","button project create"),l.textContent="NEW PROJECT",l.addEventListener("click",(function(){!function(){var e=document.querySelector("#container");if(document.querySelector("#create-project-modal"))console.log("project create form already open");else{var t=document.createElement("section");t.setAttribute("id","create-project-modal"),t.setAttribute("class","modal");var n=document.createElement("section");n.setAttribute("class","modal-content");var a=document.createElement("label");a.setAttribute("for","pname"),a.textContent="Name";var c=document.createElement("input");c.setAttribute("id","pname");var d=document.createElement("label");d.setAttribute("for","pdesc"),d.textContent="Description";var i=document.createElement("input");i.setAttribute("id","pdesc");var l=document.createElement("label");l.setAttribute("for","pduedate"),l.textContent="Due Date";var u=document.createElement("input");u.setAttribute("id","pduedate"),u.setAttribute("type","date");var p=document.createElement("label");p.setAttribute("for","pcolor"),p.textContent="Colour";var s=document.createElement("select");s.setAttribute("id","pcolor");var m=document.createElement("option");m.setAttribute("value","grey"),m.textContent="Grey";var v=document.createElement("option");v.setAttribute("value","blue"),v.textContent="Blue";var b=document.createElement("option");b.setAttribute("value","red"),b.textContent="Red";var C=document.createElement("option");C.setAttribute("value","green"),C.textContent="Green",s.appendChild(m),s.appendChild(v),s.appendChild(b),s.appendChild(C);var h=document.createElement("button");h.textContent="Create project",n.appendChild(a),n.appendChild(c),n.appendChild(d),n.appendChild(i),n.appendChild(l),n.appendChild(u),n.appendChild(p),n.appendChild(s),n.appendChild(h),t.appendChild(n),e.appendChild(t),h.addEventListener("click",o),window.onclick=function(e){e.target==t&&r()}}}()})),i.appendChild(l)}function t(e){for(var r,c=n.readProjectArray(),o=n.readItemArray(),i=0;i<c.length;i++)null==e&&(e=c[i].id),c[i].id==e&&(r=c[i]);var l=document.querySelector("#container-todolist");l.innerHTML="";var u=document.createElement("section");u.setAttribute("id","container-project-".concat(r.id)),l.setAttribute("class","todolist ".concat(r.labelColor)),o.forEach((function(e){if(e.project==r.id){var c=document.createElement("section");c.setAttribute("id","container-item-".concat(e.id)),c.setAttribute("class","item");var o=document.createElement("input");o.setAttribute("id","item-checkbox"),o.setAttribute("type","checkbox"),o.addEventListener("change",(function(){d(e.project,e.id,e.title,e.description,e.dueDate,this.checked)})),e.isComplete&&(c.setAttribute("class","item completed"),o.checked=!0);var i=document.createElement("section"),l=document.createElement("p");l.textContent=e.title;var p=document.createElement("p");p.textContent=" - ".concat(e.description);var s=document.createElement("p");s.textContent=" - ".concat(e.dueDate),i.appendChild(l),i.appendChild(p),i.appendChild(s);var m=document.createElement("button");m.setAttribute("class","button item update"),m.textContent="edit",m.addEventListener("click",(function(){!function(e){for(var t,r=n.readItemArray(),a=0;a<r.length;a++)r[a].id==e&&(t=r[a]);var c=document.querySelector("#container-item-".concat(t.id));if(document.querySelector("#update-item-form-".concat(t.id)))console.log("item update form already open");else{var o=document.createElement("section");o.setAttribute("id","update-item-form-".concat(t.id));var i=document.createElement("label");i.setAttribute("for","itemname"),i.textContent="Name";var l=document.createElement("input");l.setAttribute("id","itemname"),l.value=t.title;var u=document.createElement("label");u.setAttribute("for","itemdesc"),u.textContent="Description";var p=document.createElement("input");p.setAttribute("id","itemdesc"),p.value=t.description;var s=document.createElement("label");s.setAttribute("for","itemduedate"),s.textContent="Due Date";var m=document.createElement("input");m.setAttribute("id","itemduedate"),m.setAttribute("type","date"),m.value=t.dueDate;var v=document.createElement("button");v.textContent="Update item",o.appendChild(i),o.appendChild(l),o.appendChild(u),o.appendChild(p),o.appendChild(s),o.appendChild(m),o.appendChild(v);for(var b=c.childNodes,C=0;C<b.length;C++)b[C].style.display="none";c.insertBefore(o,c.firstChild),v.addEventListener("click",(function(){var e=t.id;d(t.project,e,l.value,p.value,m.value,t.isComplete)}))}}(e.id)}));var v=document.createElement("button");v.setAttribute("class","button item delete"),v.textContent="x",v.addEventListener("click",(function(){!function(e,n){a.deleteItem(n),t(e)}(e.project,e.id)})),c.appendChild(o),c.appendChild(i),c.appendChild(m),c.appendChild(v),u.appendChild(c)}}));var p=document.createElement("button");p.setAttribute("class","button item create"),p.textContent="+",p.addEventListener("click",(function(){var e=function(e){if(!document.querySelector("#create-item-form-p".concat(e))){var n=document.createElement("section");n.setAttribute("id","create-item-form-p".concat(e));var r=document.createElement("label");r.setAttribute("for","itemname"),r.textContent="Name";var c=document.createElement("input");c.setAttribute("id","itemname");var o=document.createElement("label");o.setAttribute("for","itemdesc"),o.textContent="Description";var d=document.createElement("input");d.setAttribute("id","itemdesc");var i=document.createElement("label");i.setAttribute("for","itemduedate"),i.textContent="Due Date";var l=document.createElement("input");l.setAttribute("id","itemduedate"),l.setAttribute("type","date");var u=document.createElement("button");return u.textContent="Create item",n.appendChild(r),n.appendChild(c),n.appendChild(o),n.appendChild(d),n.appendChild(i),n.appendChild(l),n.appendChild(u),u.addEventListener("click",(function(){!function(e){var n=document.querySelector("#itemname").value,r=document.querySelector("#itemdesc").value,c=document.querySelector("#itemduedate").value;a.createItem(n,r,e,c),t(e)}(e)})),n}console.log("item create form already open")}(r.id);e&&u.appendChild(e)})),u.appendChild(p),l.appendChild(u)}function r(){document.querySelector("#create-project-modal").remove()}function c(){document.querySelector("#delete-project-modal").remove()}function o(){var t=document.querySelector("#pname").value,n=document.querySelector("#pdesc").value,c=document.querySelector("#pduedate").value,o=document.querySelector("#pcolor").value;a.createProject(t,n,c,o),r(),e()}function d(e,n,r,c,o,d){a.updateItem(n,r,c,o,d),t(e)}return{displayProjects:e,displayToDoList:t}}(),a=function(){function a(e){for(var t=n.readItemArray(),r=0;r<t.length;r++)t[r].id==e&&t.splice(r,1);n.saveItemArray(t)}return function(){var r=n.readProjectArray(),a=n.readItemArray();if(0==r.length){var c=e("Shopping","Grocery list","2021-05-01","green");r.push(c),n.saveProjectArray(r);var o=e("Fitness","Eye of the tiger","2021-04-27","blue");r.push(o),n.saveProjectArray(r);var d=e("Trading","Stocks and shares","2021-04-27","red");r.push(d),n.saveProjectArray(r)}if(0==a.length){var i=t("Fruit","apples, oranges, bananas",1,"2021-04-27");a.push(i),n.saveItemArray(a);var l=t("Pullups","3 x 10",2,"2021-04-27");a.push(l),n.saveItemArray(a);var u=t("Squats","5 sets of 8 x 90kg",2,"2021-04-27");a.push(u),n.saveItemArray(a)}}(),r.displayProjects(),r.displayToDoList(1),{createProject:function(t,r,a,c){var o=e(t,r,a,c),d=n.readProjectArray();d.push(o),n.saveProjectArray(d)},createItem:function(e,r,a,c){var o=t(e,r,a,c),d=n.readItemArray();d.push(o),n.saveItemArray(d)},updateProject:function(e,t,r,a,c){for(var o,d=n.readProjectArray(),i=0;i<d.length;i++)d[i].id==e&&(o=d[i]);o&&(o.title=t,o.description=r,o.dueDate=a,o.labelColor=c,n.saveProjectArray(d))},updateItem:function(e,t,r,a,c){for(var o,d=n.readItemArray(),i=0;i<d.length;i++)d[i].id==e&&(o=d[i]);o&&(o.title=t,o.description=r,o.dueDate=a,o.isComplete=c,n.saveItemArray(d))},deleteProject:function(e){for(var t=n.readProjectArray(),r=n.readItemArray(),c=0;c<r.length;c++)r[c].project==e&&a(r[c].id);for(c=0;c<t.length;c++)t[c].id===e&&t.splice(c,1);n.saveProjectArray(t)},deleteItem:a}}()})();